unit etenem;interfaceuses  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,  StdCtrls, ExtCtrls, puhekup7, jakok2, kellocom, Grids, ComCtrls, owngrid,  Menus, luku;type  Tlomake = class(TForm)    KomentoPaneeli: TPanel;    Seuraava: TButton;    Edellinen: TButton;    Kello: Tkello;    Kupla: Tkupla;    VastausSelite: TLabel;    VastausTieto: TEdit;    Syota: TButton;    Timer: TTimer;    Laskuri: TLabel;    VaiheLaskuri: TLabel;    Jakokulma: Tjakok;    Jaannostaulu: TOwnGrid;    Numerotaulu: TOwnGrid;    ColorDialog: TColorDialog;    SaveDialog: TSaveDialog;    OpenDialog: TOpenDialog;    ErillinenKorostusLuku: Tluku;    MainMenu: TMainMenu;    KelloVariItem: TMenuItem;    KelloReunusVariItem: TMenuItem;    KelloViisariVariItem: TMenuItem;    KelloNumeroVariItem: TMenuItem;    KelloPohjaVariItem: TMenuItem;    JakokulmaVariItem: TMenuItem;    JakokulmaViivaVariItem: TMenuItem;    JakokulmaTekstiVariItem: TMenuItem;    JakokulmaPohjaVariItem: TMenuItem;    JakokulmaKorostusVariItem: TMenuItem;    KokoomatauluVariItem: TMenuItem;    KokoomatauluReunusVariItem: TMenuItem;    KokoomatauluTekstiVariItem: TMenuItem;    NumerotauluVariItem: TMenuItem;    NumeroTauluTekstiVariItem: TMenuItem;    NumerotauluKorostusVariItem: TMenuItem;    NumerotauluPohjaVariItem: TMenuItem;    KokoomatauluPohjaVariItem: TMenuItem;    JaannostauluVariItem: TMenuItem;    JaannostauluTekstiVariItem: TMenuItem;    JaannostauluPohjaVariItem: TMenuItem;    JaannostauluKorostusVariItem: TMenuItem;    LomakePohjaVariItem: TMenuItem;    LaskuriVariItem: TMenuItem;    KelloViivaVariItem: TMenuItem;    PaneeliVariItem: TMenuItem;    PaneeliTekstiVariItem: TMenuItem;    LomakeTekstiVariItem: TMenuItem;    LomakeTekstiKorostusVariItem: TMenuItem;    VaritTiedostoissaItem: TMenuItem;    LataaVaritItem: TMenuItem;    TallennaVaritItem: TMenuItem;    VaritItem: TMenuItem;    ErillinenKorostusLukuItem: TMenuItem;    ErillinenKorostusLukuTekstiVariItem: TMenuItem;    ErillinenKorostusLukuKorostusVariItem: TMenuItem;    NumerotauluReunusItem: TMenuItem;    JaannostauluReunusItem: TMenuItem;    MuutaItem: TMenuItem;    JaannostaulunLuontiKorostusVariItem: TMenuItem;    AlkuperaisVaritItem: TMenuItem;    Image: TImage;    Taustakuva1: TMenuItem;    PoistataustakuvaItem: TMenuItem;    procedure haeteksti;    procedure asetanumerolaatikonalarivi( Sender : TObject );    procedure tyhjaajjtaulukko( Sender : TObject );    procedure luojjtaulukko( Sender : TObject );    procedure tyhjaagrid( Sender : TObject );    procedure taydennatulostaul( Sender : TObject );    procedure palautaalkuperkoontitaulukko( Sender : TObject );    procedure vielukulaatikkoon( Sender : TObject; luku : integer );    procedure laskevasemmat( Sender : TObject );    procedure laskeoikeat( Sender : TObject );    procedure pyoritasata( Sender : TObject );    procedure pyoritalaatikkoluvut( Sender : TObject );    procedure pyoritakolmekertnelja( Sender : TObject );    procedure pyoritatuhat( Sender : Tobject );    procedure toteutavaihe( Sender : TObject );    procedure luo(Sender: TObject);    procedure Seuraavavaihe(Sender: TObject);    procedure edelvaihe(Sender: TObject);    procedure asetanappulanakyvyydet( Sender : TObject );    procedure ontimer(Sender: TObject);    procedure tuhoa(Sender: TObject);    procedure estakoonmuutos(Sender: TObject);    procedure alustavarit(Sender: TObject);    procedure LomakePohjaVari(Sender: TObject);    procedure LomakeTekstiVari(Sender: TObject);    procedure LomakeTekstiKorostusVari(Sender: TObject);    procedure LaskuriVari(Sender: TObject);    procedure ErillinenKorostusLukuTekstiVari(Sender: TObject);    procedure ErillinenKorostusLukuKorostusVari(Sender: TObject);    procedure PaneeliVari(Sender: TObject);    procedure PaneeliTekstiVari(Sender: TObject);    procedure KelloViivaVari(Sender: TObject);    procedure KelloReunusVari(Sender: TObject);    procedure KelloViisariVari(Sender: TObject);    procedure KelloNumeroVari(Sender: TObject);    procedure KelloPohjaVari(Sender: TObject);    procedure JakokulmaViivaVari(Sender: TObject);    procedure JakokulmaTekstiVari(Sender: TObject);    procedure JakokulmaPohjaVari(Sender: TObject);    procedure JakokulmaKorostusVari(Sender: TObject);    procedure AsetaNumerotauluReunus(Sender: TObject; vari : TColor );    procedure NumerotauluReunus(Sender: TObject);    procedure AsetaNumerotauluTekstiVari(Sender: TObject; vari : TColor );    procedure NumerotauluTekstiVari(Sender: TObject);    procedure NumerotauluKorostusVari(Sender: TObject);    procedure NumerotauluPohjaVari(Sender: TObject);    procedure AsetaKokoomatauluReunusVari(Sender: TObject; vari : TColor );    procedure KokoomatauluReunusVari(Sender: TObject);    procedure AsetaKokoomatauluTekstiVari(Sender: TObject; vari : TColor );    procedure KokoomatauluTekstiVari(Sender: TObject);    procedure KokoomatauluPohjaVari(Sender: TObject);    procedure AsetaJaannostauluReunus(Sender: TObject; vari : TColor );    procedure JaannostauluReunus(Sender: TObject);    procedure AsetaJaannostauluTekstiVari(Sender: TObject; vari : TColor );    procedure JaannostauluTekstiVari(Sender: TObject);    procedure JaannostauluPohjaVari(Sender: TObject);    procedure JaannostauluKorostusVari(Sender: TObject);    procedure JaannosTaulunLuontiKorostusVari(Sender: TObject);    procedure LataaVarit(Sender: TObject);    procedure TalletaVarit(Sender: TObject);    procedure paivitaalkuun(Sender: TObject; var Action: TCloseAction);    procedure alkuas(Sender: TObject);    procedure teeotsake(Sender: TObject);    procedure alkupervarit(Sender:TObject);    procedure laitamuut(Sender: TObject; Stage: TProgressStage;      PercentDone: Byte; RedrawNow: Boolean; const R: TRect;      const Msg: String);    procedure Taustakuva(Sender: TObject);    procedure Poistakuva(Sender: TObject);  private    Kokoomataulu : TOwnGrid;    { Private declarations }  public    { Public declarations }  end;var  lomake: Tlomake;  numero : integer;  timingprocessn : integer;  maxvaihe,vaihe : integer;  virhemaara : integer;  pyoritys : integer;  pyoraskel,pyorkierroksia : integer;  rollsec,rollsteps : integer;  numerotaulkorostv, jaannostaulkorostv,  Laskuriv : TColor;  rolledsteps : integer;  rolledsecs : integer;  alkupaikka : integer;  ErilKorostLukuKorostVari,  Jaannostaululuontikorostv,  paneelitekstiv, Kokoomataulurvari,  kokoomataultvari, numerotaultvari,  jaannostaultvari : TColor;  onvarit : Boolean;implementationuses huom, valikko;{$R *.DFM}procedure kelaatyhjatrivit( var Tiedosto : TextFile ; var rivi : string );begin  readln(Tiedosto,rivi);  while (rivi='') do readln(Tiedosto,rivi);end;procedure kelaatyhjat( rivi : string; var ind : integer );begin  while (rivi[ind]=' ') do Inc(ind);end;procedure haeluku( rivi : string; var ind,luku : integer );begin  luku := 0;  while (rivi[ind]>='0') and (rivi[ind]<='9') do begin    luku := 10*luku+(Ord(rivi[ind])-Ord('0'));    Inc(ind);  end;end;procedure haetiedot( rivi : string; var vnro,rivimaara : integer );var ind : integer;begin  ind := 1;  kelaatyhjat(rivi,ind);  haeluku(rivi,ind,vnro);  kelaatyhjat(rivi,ind);  Inc(ind);  kelaatyhjat(rivi,ind);  haeluku(rivi,ind,rivimaara);end;procedure Tlomake.haeteksti;var Tiedosto : TextFile;    i,j,vnro,rivimaara : integer;    rivi : string;begin  AssignFile(Tiedosto,'tekstit.txt');  Reset(Tiedosto);  kupla.Text.Clear;  for i:=1 to vaihe-1 do begin    kelaatyhjatrivit( Tiedosto, rivi );    haetiedot(rivi,vnro,rivimaara);    for j:=1 to rivimaara do readln(Tiedosto, rivi);  end;  kelaatyhjatrivit( Tiedosto, rivi );  haetiedot(rivi,vnro,rivimaara);  for j:=1 to rivimaara do begin    readln(Tiedosto, rivi);    Kupla.Text.Add(rivi);  end;  CloseFile(Tiedosto);end;procedure Tlomake.pyoritasata( Sender : TObject );{ Aloittaa 100, 200 ja 300:n kohdalla olevan kellon  pyûrittÉmisen 100 askelta eteenpÉin. }begin  timingprocessn := 5;  rolledsteps := 0;rolledsecs := 0;  alkupaikka := Kello.PointerTime;  Timer.Interval := 1;  Seuraava.visible := false;  Seuraava.EnAbled := false;  Timer.EnAbled := true;end;procedure Tlomake.tyhjaajjtaulukko( Sender : TObject );{ TyhjÉÉ jÉÉnnûstaulukon. }var i : integer;begin  Jaannostaulu.PaintAllOnCellChange := false;  for i:=1 to 8 do Jaannostaulu.Cells[1,i] := '';  if onvarit then Jaannostaulu.PaintAllOnCellChange := true;  Jaannostaulu.RePaint;end;procedure Tlomake.tyhjaagrid( Sender : TObject );{ TyhjÉÉ numerolaatikon. }var i,j : integer;begin  Numerotaulu.PaintOnChange := false;  for i := 1 to 6 do    for j:= 1 to 5 do Numerotaulu.Cells[j,i] := '';  if onvarit then Numerotaulu.PaintAllOnCellChange := true;  {  Numerotaulu.RePaint; }  Numerotaulu.visible := false;  Lomake.RePaint;end;procedure Tlomake.vielukulaatikkoon( Sender : TObject; luku : integer );{ Vie integer-muodossa annetun luvun numerolaatikon  ylÉriville. }var lukumj : string;    indeksi,pituus : integer;begin  lukumj := IntToStr(luku);pituus := length(lukumj);  Numerotaulu.PaintOnChange := false;  for indeksi := 1 to pituus do    Numerotaulu.Cells[1,indeksi] := Copy(lukumj,indeksi,1);  Numerotaulu.PaintOnChange := true;  Numerotaulu.RePaint;end;procedure Tlomake.laskeoikeat( Sender : TObject );{ Laskee numerolaatikossa ykkûsiÉ ja kymmeniÉ  merkitsevÉt luvut Pascalin algoritmin mukaisesti  kertoen kymmenet 10:llÉ ja ykkûset 1:llÉ. }begin  Numerotaulu.PaintOnChange := false;  Numerotaulu.Cells[2,5] := '*';  Numerotaulu.Cells[2,6] := '*';  Numerotaulu.Cells[3,5] := '10';  Numerotaulu.Cells[3,6] := '1';  Numerotaulu.Cells[4,5] := '=';  Numerotaulu.Cells[4,6] := '=';  Numerotaulu.Cells[5,5] :=    IntToStr( StrToInt(Numerotaulu.Cells[1,5]) *              StrToInt(Numerotaulu.Cells[3,5]) );  Numerotaulu.Cells[5,6]:=    IntToStr( StrToInt(Numerotaulu.Cells[1,6]) *              StrToInt(Numerotaulu.Cells[3,6]) );  Numerotaulu.PaintOnChange := true;  Numerotaulu.RePaint;end;procedure Tlomake.laskevasemmat( Sender : TObject );{ Laskee numerolaatikossa vasemmalla puolella olevat  satoja, tuhansia, jne. merkitsevÉt numerot alle  numerolaatikkoon kertoen ne neljÉllÉ vastaten  Pascalin algoritmia. }var indeksi : integer;begin  Numerotaulu.PaintOnChange := false;  for indeksi := 1 to 4 do begin    Numerotaulu.Cells[2,indeksi] := '*';    Numerotaulu.Cells[3,indeksi] := '4';    Numerotaulu.Cells[4,indeksi] := '=';    Numerotaulu.Cells[5,indeksi] :=      IntToStr( StrToInt(Numerotaulu.Cells[1,indeksi]) *                StrToInt(Numerotaulu.Cells[3,indeksi]) );  end;  Numerotaulu.PaintOnChange := true;end;procedure Tlomake.asetanumerolaatikonalarivi( Sender : TObject );{ Asettaa numerolaatikon alarivin, joka on voinut olla  korostettuna, takaisin ( mustaksi ? ) }var j : integer;begin  Numerotaulu.PaintOnChange := false;  for j:=1 to 6 do Numerotaulu.Colors[5,j] := clBlack;  Numerotaulu.PaintOnChange := true;  Numerotaulu.RePaint;end;procedure Tlomake.pyoritalaatikkoluvut( Sender : TObject );{ Aloittaa numerolaatikon numeroiden pyûrityksen kellossa. }var i : integer;    aikalask : integer;    uusiaika : integer;begin  Numerotaulu.RePaint;  Kello.PointerTime := 12;  Timer.Interval := 1000; { oikea 3000 }  timingprocessn := 1;  numero := 0;  Seuraava.visible := false;  Seuraava.Enabled := false;  Numerotaulu.PaintAllOnCellChange := false;  Timer.Enabled := true;end;procedure Tlomake.pyoritatuhat( Sender : TObject );{ Aloittaa 1000, 10000 ja 100000:n kohdalla  kellon pyûrittÉmisen 10*4 askelta eteenpÉin  kÉyttÉen laskuria. }begin  Timer.Interval := 500;  timingprocessn := 2;  numero := 0;  Seuraava.visible := false;  Laskuri.Caption := '0*4';  Laskuri.visible := true;  Timer.Enabled := true;end;procedure Tlomake.pyoritakolmekertnelja( Sender : TObject );{ Aloittaa 3101 luvun kohdalla kellon pyûrittÉmisen  3*4 askelta eteenpÉin kÉyttÉen erillistÉ korostuslukua  luvun 3101 esittÉmiseen. }begin  Timer.Interval := 500;  timingprocessn := 3;  ErillinenKorostusLuku.BeginInd := 1;ErillinenKorostusLuku.EndInd := 1;  ErillinenKorostusLuku.SpecialTextColor :=    ErilKorostLukuKorostVari;  numero := 0;  Seuraava.visible := false;  Laskuri.Caption := '0*4';  Laskuri.visible := true;  Timer.Enabled := true;end;procedure Tlomake.luo( Sender: TObject );{ Suoritetaan lomakkeen luonnin yhteydessÉ.  Luodaan Kokoomataulu ja sen viiva-asetukset  sekÉ paikka (500,200,500+250,200+150),  solunleveydet=115 ja korkeudet=25, fontti=14,  JÉÉnnûstaulu ja sen viiva-asetukset sekÉ  numerotaulu ja sen viiva-asetukset.  Viivanpaksuus=2.  LisÉksi asetetaan vÉrit asetus aluksi pois  ja asetetaan taulukoiden muutospiirto-ominaisuudet  aluksi siten, ettÉ normaalisti piirretÉÉn  muutoksen tultua mutta ei kaikkea, kun on pelkÉstÉ  solumuutoksesta (teksti,vÉri tai viiva-asetus)  kysymys. }var i,j : integer;    viivanelio : TLineSquare;    viiva : TLine;begin  { Kokoomataulun luonti ja muokkaus halutuksi }  Kokoomataulu := TOwnGrid.Create(Self);  Kokoomataulu.Parent := self;  Kokoomataulu.PaintOnChange := false;  Kokoomataulu.ColAmount := 2;  Kokoomataulu.RowAmount := 5;  for i:=1 to 2 do Kokoomataulu.ColWidths[i] := 115;  for i:=1 to 5 do Kokoomataulu.RowHeights[i] := 25;  Kokoomataulu.Top := 200;  Kokoomataulu.Left := 500;  Kokoomataulu.Width := 250;  Kokoomataulu.Height := 150;  viiva.Width := 2;  viiva.Visible := false;  viiva.Color := clblack;  viivanelio.LeftLine := viiva;  viivanelio.RightLine := viiva;  viivanelio.TopLine := viiva;  viivanelio.BottomLine := viiva;  { TyhjÉtÉÉn grid -nÉkyvyys }  for i := 1 to 5 do    for j := 1 to 2 do      Kokoomataulu.Lines[i,j] := viivanelio;  { vasen ylÉnurkka _|}  viivanelio.RightLine.Visible := true;  viivanelio.BottomLine.Visible := true;  Kokoomataulu.Lines[1,1] := viivanelio;  { oikea ylÉnurkka |_ }  viivanelio.LeftLine.Visible := true;  viivanelio.RightLine.Visible := false;  Kokoomataulu.Lines[1,2] := viivanelio;  { oikean ylÉnurkan alla |¿ }  viivanelio.BottomLine.Visible := false;  viivanelio.TopLine.Visible := true;  Kokoomataulu.Lines[2,2] := viivanelio;  { vasemman ylÉnurkan alla ¿| }  viivanelio.RightLine.Visible := true;  viivanelio.LeftLine.Visible := false;  Kokoomataulu.Lines[2,1] := viivanelio;  { vasemman ylÉnurkan alla riviltÉ 3 alaspÉin ' |' }  viivanelio.TopLine.Visible := false;  for i:= 3 to 5 do Kokoomataulu.Lines[i,1] := viivanelio;  { oikean ylÉnurkan alla riviltÉ 3 alaspÉin '| ' }  viivanelio.LeftLine.Visible := true;  viivanelio.RightLine.Visible := false;  for i:= 3 to 5 do Kokoomataulu.Lines[i,2] := viivanelio;  Kokoomataulu.Font.Size := 14;  { VÉrit alkuasetus }  Jaannostaulu.PaintAllOnCellChange := false;  Numerotaulu.PaintAllOnCellChange := false;  Kokoomataulu.PaintAllOnCellChange := false;  { JÉÉnnûstaulun asettaminen }  viiva.Visible := true; { viivassa on muuten vÉri musta ja paksuus 2 }  viivanelio.LeftLine := viiva;  viivanelio.RightLine := viiva;  viivanelio.TopLine := viiva;  viivanelio.BottomLine := viiva;  for i:= 1 to 8 do Jaannostaulu.Lines[1,i] := viivanelio;  { Numerotaulun asettaminen }  for i:= 1 to 5 do    for j := 1 to 6 do Numerotaulu.Lines[i,j] := viivanelio;  { Asetetaan taulujen piirtoasetukset }  Kokoomataulu.PaintOnChange := true;  Numerotaulu.PaintOnChange := true;  Jaannostaulu.PaintOnChange := true;  alkupervarit(Sender);  { Joitakin komponenttien paikkoja, jottei siirtely haittaisi }  Laskuri.Top := 176;Laskuri.Left := 325;  Numerotaulu.Top := 240;Numerotaulu.Left := 448;  Jaannostaulu.Left := 176;  ErillinenKorostusLuku.Left := 572;  ErillinenKorostusLuku.Top := 396;  Image.Visible := false;  Image.Top := 0;Image.Left := 0;  Image.Width := 790;Image.Height := 424;end;procedure Tlomake.teeotsake( Sender : TObject );{ Luodaan kokoomataulun otsake. }begin  Kokoomataulu.PaintOnChange := false;  Kokoomataulu.Cells[1,1] := 'Luku';  Kokoomataulu.Cells[1,2] := 'JakojÉÉnnûs';  Kokoomataulu.Cells[2,1] := '100';  Kokoomataulu.PaintOnChange := true;  Kokoomataulu.visible := true;  Kokoomataulu.RePaint;end;procedure Tlomake.toteutavaihe( Sender : TObject );var tekstinimi : string;    i : integer;    vaarin : Boolean;    vastausnro : integer;begin  Image.SendToBack;  Kokoomataulu.BringToFront;  VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);  tekstinimi := '\habadelp\jakojpr\jopoht'+IntToStr(vaihe)+'.txt';  case vaihe of    1 : begin        Kello.PointerTime := 12;        Jakokulma.visible := false;        tyhjaagrid( Sender );        Numerotaulu.visible := false;        Kokoomataulu.visible := false;        Kokoomataulu.SendToBack;        Numerotaulu.SendToBack;        Kello.left := 270;        Kello.top := 190;        Kupla.left := 130;        Kupla.top := 48;        haeteksti;        Kupla.Font.Size := 18;        Kupla.Width := 600;        Kupla.TextAreaWidth := 520;        end;    2 : begin        Kokoomataulu.SendToBack;        vastausnro := StrToIntDef(VastausTieto.Text,0);        if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 1;        end else if (vastausnro=5) then begin          Kupla.left := 190;          haeteksti;          vaarin := false;          rollsec := 50; rollsteps := 101; pyoritys := 9;        end else begin          vaihe := vaihe+2; { 4 }          VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);          Kello.visible := false;          Kupla.left := 16;          Kupla.Font.Size := 18;          Kupla.visible := true;          tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';          haeteksti;          Jakokulma.top := 58;Jakokulma.left := 550;          Jakokulma.DividedNumber := 213101;          Jakokulma.Divisor := 12;          Jakokulma.NumberStage := 21;          Jakokulma.visible := true;          Kokoomataulu.EnAbled := false;          Jakokulma.BringToFront;          Jakokulma.RePaint;          vaarin := true;        end;        end;    3 : begin        Kokoomataulu.SendToBack;        Kello.visible := false;        Kupla.visible := false;        Kello.left := 104;        Kupla.left := 16;        Kupla.Font.Size := 18;        Kello.visible := true;        Kello.RePaint;        Kupla.visible := true;        haeteksti;        Jakokulma.DividedNumber := 213101;        Jakokulma.Divisor := 12;        Jakokulma.top := 58;Jakokulma.left := 520;        Jakokulma.NumberStage := 21;        Jakokulma.visible := true;        Kokoomataulu.EnAbled := false;        Jakokulma.BringToFront;        Jakokulma.RePaint;        vaihe := vaihe+2; { 5 }        end;    5 : begin        Kokoomataulu.SendToBack;        Jakokulma.BringToFront;        Jakokulma.RePaint;        haeteksti;        Kello.visible := true;        Kello.top := 150;        Kello.left := 104; { vanha 14 }        rollsec := 50; rollsteps := 101; pyoritys := 9;        vaarin := false;        end;    6 : begin        Kokoomataulu.SendToBack;        Numerotaulu.BringToFront;        Kokoomataulu.EnAbled := true;        Kello.top := 190;        Kupla.Font.Size := 18;        haeteksti;        vielukulaatikkoon( Sender, 213101 );        Jakokulma.Top := 50;Jakokulma.visible := false;        end;    7 : begin        Kokoomataulu.SendToBack;        Numerotaulu.BringToFront;        haeteksti;        laskeoikeat( Sender );        end;    8 : begin        Kokoomataulu.SendToBack;        Numerotaulu.BringToFront;        haeteksti;        laskevasemmat( Sender );        asetanumerolaatikonalarivi( Sender );        end;    9 : begin        Kokoomataulu.SendToBack;        Numerotaulu.BringToFront;        haeteksti;        pyoritalaatikkoluvut( Sender );        end;    10 : begin         Kokoomataulu.SendToBack;         Numerotaulu.BringToFront;         haeteksti;         asetanumerolaatikonalarivi( Sender );         end;    11 : begin         Kello.Top := 190;         Kello.Left := 154;         virhemaara := 0;         Kupla.Font.Size := 16;         haeteksti;         Kello.PointerTime := 12;         teeotsake( Sender );         end;    12 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 11;         end else if (vastausnro=4) then begin           Kello.top := 190;           Kello.left := 104;           Kupla.font.size := 18;           Kupla.Left := 86;           haeteksti;           vaihe := vaihe+3; { 15 }           rollsec := 50;rollsteps := 100;pyoritys := 9;           Kokoomataulu.Cells[2,2] := '4';           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;         end else begin           Kello.left := 104;           if (virhemaara=0) then begin             Inc(vaihe);             Kello.top := 160;             Kupla.font.size := 18;             VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);             tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';             haeteksti;             if onvarit then begin               Kokoomataulu.RePaint;               Kokoomataulu.BringToFront;             end;             virhemaara := 1;             vaihe := vaihe-2; { 11 }           end else begin             Kello.Top := 190;             vaihe := vaihe+2; { 14 }             VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);             tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';             Kello.visible := false;             Kupla.font.size := 18;             haeteksti;             if onvarit then begin               Kokoomataulu.RePaint;               Kokoomataulu.BringToFront;             end;             Jakokulma.NumberStage := 5;             Jakokulma.DividedNumber := 100;             Jakokulma.height := 200;             Jakokulma.Top := 200;             Jakokulma.Left := 220;             Jakokulma.Font.Size := 18;             Jakokulma.visible := true;             virhemaara := 0;           end;         end;         end;    15 : begin         Jakokulma.Visible := false;         Kello.visible := true;         Kupla.Left := 16;         Kupla.font.size := 18;         haeteksti;         Kokoomataulu.Cells[2,2] := '4';         Kello.PointerTime := 12;         pyoritys := 9;rollsteps := 100;rollsec := 50;         end;    16 : begin         Kupla.Left := 16;         Kupla.font.size := 18;         haeteksti;         Kokoomataulu.Cells[3,1] := '200';         Jakokulma.visible := false;         Kello.PointerTime := 12;         end;    17 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 16;         end else if (vastausnro=8) then begin           haeteksti;           Kello.PointerTime := 12;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           rollsec := 50;rollsteps := 100;pyoritys := 9;           Inc(vaihe); { 18 }         end else begin           Inc(vaihe); { 18 }           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           Kello.PointerTime := 12;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           rollsec := 50;rollsteps := 100;pyoritys := 9;         end;         end;    19 : begin         haeteksti;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         rollsec := 50;rollsteps := 100;pyoritys := 9;         end;    20 : begin         haeteksti;         Kokoomataulu.Cells[3,2] := '8';         end;    21 : begin         haeteksti;         Kokoomataulu.Cells[4,1] := '300';         Kello.PointerTime := 12;         end;    22 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 21;         end else if (vastausnro=12) then begin           haeteksti;           Kello.PointerTime := 12;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           rollsec := 50;rollsteps := 100;pyoritys := 9;           Inc(vaihe); { 23 }         end else begin           Inc(vaihe); { 23 }           Kello.Top := 200;           Kupla.font.size := 14;           Kupla.top := 24;           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           Kello.PointerTime := 12;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           rollsec := 50;rollsteps := 100;pyoritys := 9;         end;         end;    24 : begin         Kello.top := 190;         Kupla.top := 48;         Kupla.font.size := 18;         haeteksti;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         rollsec := 50;rollsteps := 100;pyoritys := 9;         end;    25 : begin         haeteksti;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         rollsec := 50;rollsteps := 100;pyoritys := 9;         end;    26 : begin         haeteksti;         Kokoomataulu.Cells[4,2] := '0';         end;    27 : begin         Kupla.font.size := 18;         haeteksti;         Kokoomataulu.Cells[5,1] := '1000';         Kello.PointerTime := 12;         Laskuri.Top := 176;         end;    28 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 48;         end else if (vastausnro=4) then begin           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 1;         end else begin           vaihe := vaihe+2; { 30 }           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           Laskuri.Top := 191;           pyoritys := 1;         end;         end;    29 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[5,2] := '4';         vaihe := vaihe+2; { 31 }         end;    31 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[5,2] := '4';         end;    32 : begin         Kello.PointerTime := 12;         Kupla.font.size := 14;         haeteksti;         Kokoomataulu.PaintOnChange := false;         Kokoomataulu.Cells[3,1] := '1000';         Kokoomataulu.Cells[3,2] := '4';         Kokoomataulu.Cells[4,1] := '';         Kokoomataulu.Cells[4,2] := '';         Kokoomataulu.Cells[5,1] := '';         Kokoomataulu.Cells[5,2] := '';         Kokoomataulu.PaintOnChange := true;         Kokoomataulu.RePaint;         end;    33 : begin         Laskuri.Top := 176;         Kupla.font.size := 18;         haeteksti;         Kokoomataulu.Cells[4,1] := '10000';         Kello.PointerTime := 12;         end;    34 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 33;         end else if (vastausnro=4) then begin           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 1;         end else begin           vaihe := vaihe+2; { 36 }           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           Laskuri.Top := 191;           pyoritys := 1;         end;         end;    35 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[4,2] := '4';         vaihe := vaihe+2; { 37 }         end;    37 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[4,2] := '4';         end;    38 : begin         Laskuri.Top := 176;         haeteksti;         Kokoomataulu.Cells[5,1] := '100000';         Kello.PointerTime := 12;         end;    39 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 38;         end else if (vastausnro=4) then begin           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 1;         end else begin           vaihe := vaihe+2; { 41 }           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           Laskuri.Top := 191;           pyoritys := 1;         end;         end;    40 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[5,2] := '4';         vaihe := vaihe+2; { 42 }         end;    42 : begin         Laskuri.visible := false;         haeteksti;         Kokoomataulu.Cells[5,2] := '4';         end;    43 : begin         Kello.PointerTime := 12;         Laskuri.Top := 176;         haeteksti;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         end;    44 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 43;         end else if (vastausnro=5) then begin           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           Inc(vaihe);ErillinenKorostusLuku.visible := true; { 45 }           ErillinenKorostusLuku.SpecialTextColor :=             ErillinenKorostusLuku.Font.Color;           pyoritys := 2;         end else begin           Inc(vaihe);           ErillinenKorostusLuku.visible := true;           ErillinenKorostusLuku.SpecialTextColor :=             ErillinenKorostusLuku.Font.Color;           Kello.Top := Kello.top+10;           Laskuri.Top := Laskuri.top+15;           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           Kupla.Font.Size := 16;           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 2;         end;         end;    46 : begin         Kello.top := 190;         Laskuri.top := 162;         Kupla.Font.size := 18;         haeteksti;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         Kello.PointerTime := 4;         ErillinenKorostusLuku.EndInd := 2;         end;    47 : begin         haeteksti;         Kello.PointerTime := 5;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         ErillinenKorostusLuku.EndInd := 4;         end;    48 : begin         ErillinenKorostusLuku.visible := false;         Kupla.Left := 16;         haeteksti;         Kello.PointerTime := 12;         Kokoomataulu.left := 500;         Kokoomataulu.Top := 200;         if onvarit then begin           Kokoomataulu.RePaint;           Kokoomataulu.BringToFront;         end;         end;    49 : begin         vastausnro := StrToIntDef(VastausTieto.Text,0);         if (vastausnro<=0) or (vastausnro>12) then begin           huomlomake.ShowModal;           vaihe := 48;         end else if (vastausnro=5) then begin           Kupla.font.size := 14;           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 3;         end else begin           Inc(vaihe); { 50 }           Kello.top := Kello.top +10;           Laskuri.top := Laskuri.top+ 20;           Kupla.font.size := 14;           VaiheLaskuri.Caption := 'Vaihe ' + IntToStr(vaihe);           tekstinimi := 'jopoht'+IntToStr(vaihe)+'.txt';           haeteksti;           if onvarit then begin             Kokoomataulu.RePaint;             Kokoomataulu.BringToFront;           end;           pyoritys := 3;         end;         end;    51 : begin         Kupla.Left := 100;         Kello.top := 190;         Laskuri.Top := 162;         Kupla.font.size := 18;         Kello.Visible := false;         Kokoomataulu.Left := 260;         Kokoomataulu.Top := 230;         Jaannostaulu.top := 160;         haeteksti;         Jaannostaulu.visible := true;         Kokoomataulu.visible := true;         taydennatulostaul( Sender );         luojjtaulukko( Sender );         end;    52 : begin         haeteksti;         Jaannostaulu.Top := Jaannostaulu.top+50;         Kokoomataulu.visible := false;         end;  end;  asetanappulanakyvyydet( Sender );end;procedure Tlomake.asetanappulanakyvyydet( Sender:TObject );begin  if (vaihe>=6) and (vaihe<=10) then    Numerotaulu.visible := true  else Numerotaulu.visible := false;  if (vaihe=maxvaihe) then begin    Seuraava.Visible := false;    Seuraava.Enabled := false;  end else begin    Seuraava.Visible := true;    Seuraava.Enabled := true;  end;  if (vaihe=5)  or (vaihe=7) or (vaihe=8) or     (vaihe=11) or (vaihe=16) or     (vaihe=21) or (vaihe=27) or (vaihe=32) or     (vaihe=33) or (vaihe=38) or (vaihe=43) or     (vaihe=48) or (vaihe>=51) then begin    Edellinen.Visible := true;    Edellinen.Enabled := true;  end else begin    Edellinen.Visible := false;    Edellinen.Enabled := false;  end;  if (vaihe=1 ) or (vaihe=11) or (vaihe=16) or     (vaihe=21) or (vaihe=27) or (vaihe=33) or     (vaihe=38) or (vaihe=40) or (vaihe=43) or     (vaihe=48)  then begin    Syota.Visible := true;    Syota.Enabled := true;    VastausTieto.Visible := true;    VastausSelite.visible := true;    Seuraava.Visible := false;    Seuraava.Enabled := false;  end else begin    Syota.visible := false;    Syota.Enabled := false;    VastausTieto.Visible := false;    VastausSelite.Visible := false;  end;  VastausTieto.text := '';end;procedure Tlomake.Seuraavavaihe(Sender: TObject);begin  if (Timer.Enabled=false) then begin    if (pyoritys=1) then pyoritatuhat(Sender);    if (pyoritys=2) then pyoritakolmekertnelja(Sender);    if (pyoritys>2) and (pyoritys<=8) then begin      if (vaihe=49) then begin         Kupla.ColoredTextAreaEndRow := 2;         Kupla.ColoredTextAreaBeginRow := 2;      end else begin         Kupla.ColoredTextAreaEndRow := 3;         Kupla.ColoredTextAreaBeginRow := 3;      end;      Kupla.ColoredTextAreaEndCol := 26;      Kupla.ColoredTextAreaBeginCol := 24;      Kupla.ColoredTextAreaOn := true;      if (pyoritys>=4) and (vaihe=50) then        Kupla.ColoredTextAreaBeginCol := 11;      pyoraskel := 4;      case pyoritys of        3 : begin            if (vaihe=49) then begin              Kupla.ColoredTextAreaEndCol := 26;              Kupla.ColoredTextAreaBeginCol := 24;            end else begin              Kupla.ColoredTextAreaBeginCol := 11;              Kupla.ColoredTextAreaEndCol := 13;            end;            pyorkierroksia := 2;            end;        4 : begin            if (vaihe=49) then begin              Kupla.ColoredTextAreaEndCol := 30;              { Kupla.ColoredTextAreaBeginCol := 28; }            end else begin              Kupla.ColoredTextAreaEndCol := 17;              { Kupla.ColoredTextAreaBeginCol := 15; }            end;            pyorkierroksia := 1;            end;        5 : begin            if (vaihe=49) then begin              Kupla.ColoredTextAreaEndCol := 34;              { Kupla.ColoredTextAreaBeginCol := 32; }            end else begin              Kupla.ColoredTextAreaEndCol := 21;              { Kupla.ColoredTextAreaBeginCol := 19; }            end;            pyorkierroksia := 3;            end;        6 : begin            if (vaihe=49) then begin              Kupla.ColoredTextAreaEndCol := 38;              { Kupla.ColoredTextAreaBeginCol := 36; }            end else begin              Kupla.ColoredTextAreaEndCol := 25;              { Kupla.ColoredTextAreaBeginCol := 23; }            end;            pyorkierroksia := 1;            end;        7 : begin            if (vaihe=49) then begin              Kupla.ColoredTextAreaEndCol := 40;              { Kupla.ColoredTextAreaBeginCol := 40; }            end else begin              Kupla.ColoredTextAreaEndCol := 27;              { Kupla.ColoredTextAreaBeginCol := 27; }            end;            pyoraskel := 1;            end;        8 : begin            pyoritys := -1;            Kupla.ColoredTextAreaOn := false;            Kupla.ColoredTextAreaBeginRow := 2;            Kupla.ColoredTextAreaEndRow := 2;            vaihe := 50;            end;      end;      if (pyoritys>-1) then begin        Timer.Interval := 500;        Timer.Enabled := true;      end;      Inc(pyoritys);      timingprocessn := 4;      numero := 1;      if onvarit then begin        Kokoomataulu.RePaint;        Kokoomataulu.BringToFront;      end;    end;    if (pyoritys=0) then begin      Inc(vaihe);      toteutavaihe( Sender );    end;    if (pyoritys=9) then pyoritasata( Sender );  end;end;procedure Tlomake.edelvaihe(Sender: TObject);var i,j : integer;begin  if (Timer.Enabled=false) then begin    if (vaihe=5) or (vaihe=10) or (vaihe=11) then vaihe := 1;    if (vaihe=7) then begin      vaihe :=6;      Kokoomataulu.PaintOnChange := false;      for i:=2 to 5 do begin        Numerotaulu.Cells[i,5] := '';        Numerotaulu.Cells[i,6] := '';      end;      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=8) then begin      vaihe := 7;      Kokoomataulu.PaintOnChange := false;      for i:=2 to 5 do        for j:=1 to 4 do Numerotaulu.Cells[i,j] := '';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=16) then begin      Kokoomataulu.PaintOnChange := false;      Kokoomataulu.Cells[3,1] := '';      Kokoomataulu.Cells[2,2] := '';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;      virhemaara := 0;    end;    if (vaihe=21) then begin      Kokoomataulu.PaintOnChange := false;      Kokoomataulu.Cells[4,1] := '';      Kokoomataulu.Cells[3,2] := '';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=27) then begin      Kokoomataulu.PaintOnChange := false;      Kokoomataulu.Cells[5,1] := '';      Kokoomataulu.Cells[4,2] := '';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=32) then begin      Kokoomataulu.PaintOnChange := false;      Kokoomataulu.Cells[3,1] := '200';      Kokoomataulu.Cells[3,2] := '8';      Kokoomataulu.Cells[4,1] := '300';      Kokoomataulu.Cells[4,2] := '0';      Kokoomataulu.Cells[5,1] := '1000';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=33) then Kokoomataulu.Cells[4,1] := '';    if (vaihe=38) then begin      Kokoomataulu.PaintOnChange := false;      Kokoomataulu.Cells[5,1] := '';      Kokoomataulu.Cells[4,2] := '';      Kokoomataulu.PaintOnChange := true;      Kokoomataulu.RePaint;    end;    if (vaihe=51) then Jaannostaulu.Visible := false;    if (vaihe=43) then Kokoomataulu.Cells[5,2] := '';    if (vaihe=16) then vaihe := 11;    if (vaihe=21) then vaihe := 16;    if (vaihe=27) then vaihe := 21;    if (vaihe=32) then vaihe := 27;    if (vaihe=33) then vaihe := 32;    if (vaihe=38) then vaihe := 33;    if (vaihe=43) then vaihe := 38;    if (vaihe=48) then vaihe := 43;    if (vaihe=51) then begin      vaihe := 48;Kello.visible := true;      tyhjaajjtaulukko( Sender );      palautaalkuperkoontitaulukko( Sender );    end;    if (vaihe=52) then begin      Dec(vaihe);      tyhjaajjtaulukko( Sender );    end;    toteutavaihe( Sender );  end;end;procedure Tlomake.palautaalkuperkoontitaulukko( Sender : TObject );var i : integer;begin  Kokoomataulu.PaintOnChange := false;  for i := 6 to 7 do begin    Kokoomataulu.Cells[i,1] := '';    Kokoomataulu.Cells[i,2] := '';  end;  Kokoomataulu.RowAmount := 5;  Kokoomataulu.Cells[2,1] := '100';  Kokoomataulu.Cells[2,2] := '4';  Kokoomataulu.Cells[3,1] := '1000';  Kokoomataulu.Cells[3,2] := '4';  Kokoomataulu.Cells[4,1] := '10000';  Kokoomataulu.Cells[4,2] := '4';  Kokoomataulu.Cells[5,1] := '100000';  Kokoomataulu.Cells[5,2] := '4';  Kokoomataulu.PaintOnChange := true;  Kokoomataulu.RePaint;end;procedure Tlomake.taydennatulostaul( Sender : TObject );{ TÉydennetÉÉn kokoomataulu siten, ettÉ siihen tulee kaikkiaan 7 riviÉ.  Taulun alkuun tulee 1 ja 10 sekÉ niiden jakojÉÉnnûkset ja sitten  se, mitÉ taulussa oli jo aikaisemminkin eli 100,1000, jne. jakojÉÉnnûkset.  Ohjelmassa rakennetaan taulun lisÉriveille myûs samanlaiset viivastot  ja tekstin vÉrit kuin on ylempÉnÉ taulussa. }var viivanelio : TLineSquare;    viiva : TLine;begin  Kokoomataulu.PaintOnChange := false;  Kokoomataulu.RowAmount := 7;  viiva := Kokoomataulu.Lines[3,1].RightLine;  viivanelio.RightLine := viiva;  viiva.visible := false;  viivanelio.TopLine := viiva;  viivanelio.BottomLine := viiva;  viivanelio.LeftLine := viiva;  Kokoomataulu.Lines[6,1] := viivanelio;  Kokoomataulu.Lines[7,1] := viivanelio;  viivanelio.RightLine := viiva;  viiva.visible := true;  viivanelio.LeftLine := viiva;  Kokoomataulu.Lines[6,2] := viivanelio;  Kokoomataulu.Lines[7,2] := viivanelio;  Kokoomataulu.Colors[6,1] := Kokoomataulu.Colors[1,1];  Kokoomataulu.Colors[6,2] := Kokoomataulu.Colors[1,1];  Kokoomataulu.Colors[7,1] := Kokoomataulu.Colors[1,1];  Kokoomataulu.Colors[7,2] := Kokoomataulu.Colors[1,1];    Kokoomataulu.Cells[2,1] := '1';  Kokoomataulu.Cells[2,2] := '1';  Kokoomataulu.Cells[3,1] := '10';  Kokoomataulu.Cells[3,2] := '10';  Kokoomataulu.Cells[4,1] := '100';  Kokoomataulu.Cells[4,2] := '4';  Kokoomataulu.Cells[5,1] := '1000';  Kokoomataulu.Cells[5,2] := '4';  Kokoomataulu.Cells[6,1] := '10000';  Kokoomataulu.Cells[6,2] := '4';  Kokoomataulu.Cells[7,1] := '100000';  Kokoomataulu.Cells[7,2] := '4';  Kokoomataulu.PaintOnChange := true;  Kokoomataulu.RePaint;end;procedure Tlomake.luojjtaulukko( Sender : TObject );begin  Timer.Interval := 750;  timingprocessn := 6;  numero := 1;  pyoritys := 10;  Kokoomataulu.PaintOnChange := false;  Jaannostaulu.Cells[1,1] := '12';  Jaannostaulu.Cells[1,2] := '...';  Kokoomataulu.PaintOnChange := true;  Kokoomataulu.RePaint;  Kokoomataulu.PaintAllOnCellChange := false;  Timer.Enabled := true;end;procedure Tlomake.ontimer(Sender: TObject);var uusiaika : integer;    lisays : integer;begin  if (timingprocessn=1) then    if (numero=6) then      begin      Timer.Enabled := false;pyoritys := 0;      if onvarit then Kokoomataulu.PaintAllOnCellChange := true;      end    else begin      uusiaika := (Kello.PointerTime+StrToInt(Numerotaulu.Cells[5,numero+1]))                  mod 12;      if (uusiaika=0) then uusiaika := 12;      Kello.PointerTime := uusiaika;      Laskuri.Caption := IntToStr(numero)+'*4';      Inc(numero);      Numerotaulu.Colors[5,numero] := numerotaulkorostv;      end;  if (timingprocessn=2) then    if (numero=10) then      begin Timer.Enabled := false;pyoritys := 0; end    else begin      uusiaika := (Kello.PointerTime+4) mod 12;      if (uusiaika=0) then uusiaika := 12;      Kello.PointerTime := uusiaika;      Inc(numero);      Laskuri.Caption := IntToStr(numero)+'*4';    end;  if (timingprocessn=3) then    if (numero=3) then      begin Timer.Enabled := false;pyoritys := 0; end    else begin      uusiaika := (Kello.PointerTime+4) mod 12;      if (uusiaika=0) then uusiaika := 12;      Kello.PointerTime := uusiaika;      Inc(numero);      Laskuri.Caption := IntToStr(numero)+'*4';    end;  if (timingprocessn=4) then begin    if (numero=1) and (pyorkierroksia>1) then Laskuri.Visible := true;    if (numero=pyorkierroksia) then begin      Timer.Enabled := false;      Laskuri.Visible := false;    end;    uusiaika := (Kello.PointerTime+pyoraskel) mod 12;    if (uusiaika=0) then uusiaika := 12;    Kello.PointerTime := uusiaika;    Inc(numero);    Laskuri.Caption := IntToStr(numero)+'*'+IntToStr(pyoraskel);  end;  if (timingprocessn=5) then begin    lisays := rollsteps div rollsec;    uusiaika := (Kello.PointerTime+lisays) mod 12;    if (uusiaika=0) then uusiaika := 12;    Kello.PointerTime := uusiaika;    rolledsteps := rolledsteps + lisays;    Inc(rolledsecs);    if (rolledsteps>=rollsteps) then begin      pyoritys := 0;      Timer.Enabled := false;      uusiaika := (alkupaikka+rollsteps) mod 12;      if (uusiaika=0) then uusiaika := 12;      Kello.PointerTime := uusiaika;    end;  end;  if (timingprocessn=6) then begin    if (numero>6) then begin      Timer.EnAbled := false;      Jaannostaulu.Colors[1,3] := Jaannostaulu.Font.Color;      Kokoomataulu.Colors[7,2] := Kokoomataulu.Font.Color;      if onvarit then Kokoomataulu.PaintAllOnCellChange := true;      pyoritys := 0;    end else begin      Kokoomataulu.Colors[numero+1,2] := Jaannostaululuontikorostv;      if (numero>1) then Kokoomataulu.Colors[numero,2] :=        Kokoomataulu.Font.Color;      Jaannostaulu.Cells[1,9-numero] := Kokoomataulu.Cells[numero+1,2];      Jaannostaulu.Colors[1,9-numero] := Jaannostaululuontikorostv;      if (numero>1) then Jaannostaulu.Colors[1,10-numero] :=        Jaannostaulu.Font.Color;      Inc(numero);    end;  end;  if (Timer.Enabled=false) then begin    Seuraava.visible := true;    Seuraava.EnAbled := true;    if (timingprocessn<>2) then Laskuri.visible := false;  end;end;procedure Tlomake.tuhoa(Sender: TObject);begin  Kokoomataulu.free;  vaihe := 1;end;procedure Tlomake.estakoonmuutos(Sender: TObject);begin  height := 574;  width := 805;  top := 0;left :=0;end;procedure TLomake.alustavarit(Sender: TObject);begin  Kokoomataulu.PaintAllOnCellChange := true;  Jaannostaulu.PaintAllOnCellChange := true;  Numerotaulu.PaintAllOnCellChange := true;  onvarit := true;end;procedure Tlomake.LomakePohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Kupla.Font.Color) and    (ColorDialog.Color<>Kupla.ColoredTextAreaColor) then begin    lomake.Color := ColorDialog.Color;    Kupla.FillColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.LomakeTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>lomake.Color) and     (ColorDialog.Color<>Kupla.ColoredTextAreaColor) then begin    Kupla.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.LomakeTekstiKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>lomake.Color) or     (ColorDialog.Color<>Kupla.ColoredTextAreaColor) then begin     Kupla.ColoredTextAreaColor := ColorDialog.Color;     alustavarit(Sender);  end;end;procedure Tlomake.LaskuriVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> lomake.Color) then begin    Laskuri.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.ErillinenKorostusLukuTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Lomake.Color) then begin    ErillinenKorostusLuku.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.ErillinenKorostusLukuKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> ErillinenKorostusLuku.Font.Color) and     (ColorDialog.Color <> Lomake.Color) then begin    ErilKorostLukuKorostVari := ColorDialog.Color;    ErillinenKorostusLuku.SpecialTextColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.PaneeliVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Syota.Font.Color) then begin    KomentoPaneeli.Color := ColorDialog.Color;    VastausSelite.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.PaneeliTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>KomentoPaneeli.Color) then begin    VastausSelite.Font.Color := ColorDialog.Color;    VastausTieto.Font.Color := ColorDialog.Color;    Syota.Font.Color := ColorDialog.Color;    Edellinen.Font.Color := ColorDialog.Color;    Seuraava.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.KelloViivaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Kello.FillColor) then begin    Kello.LineColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.KelloReunusVari(Sender: TObject);begin  ColorDialog.Execute;  Kello.BorderColor := ColorDialog.Color;  alustavarit(Sender);end;procedure Tlomake.KelloViisariVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Kello.FillColor) then begin    Kello.PointerColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.KelloNumeroVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Kello.FillColor) then begin    Kello.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.KelloPohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Kello.Font.Color) and    (ColorDialog.Color<>Kello.PointerColor) then begin    Kello.FillColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JakokulmaViivaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Jakokulma.BgColor) then begin    Jakokulma.LineColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JakokulmaTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Jakokulma.BgColor) then begin    Jakokulma.Font.Color := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JakokulmaPohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Jakokulma.ModColor) and     (ColorDialog.Color<>Jakokulma.Font.Color) then begin    Jakokulma.BgColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JakokulmaKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Jakokulma.BgColor) then begin    Jakokulma.ModColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure TLomake.AsetaNumerotauluReunus(Sender: TObject; vari : TColor );var viivanelio : TLineSquare;    i,j : integer;begin  Numerotaulu.PaintOnChange := false;  viivanelio := numerotaulu.Lines[1,1];  viivanelio.LeftLine.Color := vari;  viivanelio.RightLine.Color := vari;  viivanelio.TopLine.Color := vari;  viivanelio.BottomLine.Color := vari;  for i:=1 to 5 do    for j:= 1 to 6 do      numerotaulu.Lines[i,j] := viivanelio;  Numerotaulu.PaintOnChange := true;  Numerotaulu.RePaint;end;procedure Tlomake.NumerotauluReunus(Sender: TObject);begin  ColorDialog.Execute;  AsetaNumerotauluReunus(Sender,ColorDialog.Color);  alustavarit(Sender);end;procedure TLomake.AsetaNumerotauluTekstiVari(Sender: TObject; vari : TColor );var i,j : integer;begin  Numerotaulu.PaintOnChange := false;  for i:= 1 to 5 do    for j := 1 to 6 do      if (Numerotaulu.Colors[i,j]=Numerotaulu.Font.Color) then        Numerotaulu.Colors[i,j] := vari;  Numerotaulu.Font.Color := vari;  Numerotaulu.PaintOnChange := true;  Numerotaulu.Repaint;end;procedure Tlomake.NumerotauluTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Numerotaulu.BgColor) and     (ColorDialog.Color<>numerotaulkorostv) then begin    AsetaNumerotauluTekstivari(Sender,ColorDialog.Color);    alustavarit(Sender);  end;end;procedure Tlomake.NumerotauluKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Numerotaulu.BgColor) and     (ColorDialog.Color <> Numerotaulu.Font.Color) then begin    numerotaulkorostv := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.NumerotauluPohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> numerotaulkorostv) and     (ColorDialog.Color <> Numerotaulu.Font.Color) then begin    Numerotaulu.BgColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure TLomake.AsetaKokoomaTauluReunusVari(Sender: Tobject; vari: TColor );var i,j : integer;    viivanelio : TLineSquare;begin  Kokoomataulu.PaintOnChange := false;  for i:= 1 to Kokoomataulu.RowAmount do    for j := 1 to 2 do begin      viivanelio := Kokoomataulu.Lines[i,j];      viivanelio.LeftLine.Color := vari;      viivanelio.RightLine.Color := vari;      viivanelio.TopLine.Color := vari;      viivanelio.BottomLine.Color := vari;      Kokoomataulu.Lines[i,j] := viivanelio;    end;  Kokoomataulu.PaintOnChange := true;  Kokoomataulu.RePaint;end;procedure Tlomake.KokoomatauluReunusVari(Sender: TObject);begin  ColorDialog.Execute;  AsetaKokoomaTauluReunusVari(Sender,ColorDialog.Color);  alustavarit(Sender);end;procedure Tlomake.AsetaKokoomatauluTekstiVari(Sender: TObject; vari : TColor );var i,j : integer;begin  for i:= 1 to Kokoomataulu.RowAmount do    for j := 1 to 2 do      Kokoomataulu.Colors[i,j] := ColorDialog.Color;  Kokoomataulu.Font.Color := ColorDialog.Color;end;procedure Tlomake.KokoomatauluTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Kokoomataulu.BgColor) and     (ColorDialog.Color<>Jaannostaululuontikorostv) then begin    AsetaKokoomatauluTekstiVari(Sender,ColorDialog.Color);    alustavarit(Sender);  end;end;procedure Tlomake.KokoomatauluPohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color<>Kokoomataulu.Font.Color) and     (ColorDialog.Color<>Jaannostaululuontikorostv) then begin    Kokoomataulu.BgColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.AsetaJaannostauluReunus(Sender: TObject; vari : TColor );var j : integer;    viivanelio : TLineSquare;begin  viivanelio := Jaannostaulu.Lines[1,1];  viivanelio.LeftLine.Color := vari;  viivanelio.RightLine.Color := vari;  viivanelio.TopLine.Color := vari;  viivanelio.BottomLine.Color := vari;  for j:=1 to 8 do    Jaannostaulu.Lines[1,j] := viivanelio;end;procedure Tlomake.JaannostauluReunus(Sender: TObject);begin  ColorDialog.Execute;  AsetaJaannostauluReunus(Sender,ColorDialog.Color);  alustavarit( Sender );end;procedure Tlomake.AsetaJaannostauluTekstiVari(Sender: TObject; vari : TColor );var j : integer;begin  for j := 2 to 8 do      if (Jaannostaulu.Colors[1,j]=Jaannostaulu.Font.Color) then        Jaannostaulu.Colors[1,j] := ColorDialog.Color;  Jaannostaulu.Font.Color := ColorDialog.Color;end;procedure Tlomake.JaannostauluTekstiVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Jaannostaulu.BgColor) and     (ColorDialog.Color <> Jaannostaulu.Colors[1,1]) and     (ColorDialog.Color <> Jaannostaululuontikorostv) then begin    AsetaJaannostauluTekstiVari(Sender,ColorDialog.Color);    alustavarit(Sender);  end;end;procedure Tlomake.JaannostauluKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Jaannostaulu.BgColor) and     (ColorDialog.Color <> Jaannostaulu.Font.Color) and     (ColorDialog.Color <> Jaannostaululuontikorostv) then begin    Jaannostaulu.Colors[1,1] := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JaannostauluPohjaVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Jaannostaulu.Colors[1,1]) and     (ColorDialog.Color <> Jaannostaulu.Font.Color) and     (ColorDialog.Color <> Jaannostaululuontikorostv) then begin    Jaannostaulu.BgColor := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure Tlomake.JaannosTaulunLuontiKorostusVari(Sender: TObject);begin  ColorDialog.Execute;  if (ColorDialog.Color <> Kokoomataulu.Font.Color) and     (ColorDialog.Color <> Jaannostaulu.Font.Color) and     (ColorDialog.Color <> Jaannostaulu.BgColor) and     (ColorDialog.Color <> Kokoomataulu.BgColor) and     (ColorDialog.Color <> Jaannostaulu.Colors[1,1]) then begin    Jaannostaululuontikorostv := ColorDialog.Color;    alustavarit(Sender);  end;end;procedure TLomake.TalletaVarit(Sender: TObject);var tdnimi : string;    varitiedosto : File of TColor;    LineSquare : TLineSquare;    vari : TColor;begin  SaveDialog.Execute;  tdnimi := SaveDialog.Filename;  AssignFile(varitiedosto,tdnimi);  ReWrite(varitiedosto);  write(varitiedosto,lomake.Color);  write(varitiedosto,Kupla.Font.Color);  write(varitiedosto,Kupla.ColoredTextAreaColor);  write(varitiedosto,Laskuri.Font.Color);  write(varitiedosto,ErillinenKorostusLuku.Font.Color);  write(varitiedosto,ErilKorostLukuKorostVari);  write(varitiedosto,KomentoPaneeli.Color);  write(varitiedosto,VastausSelite.Font.Color);  write(varitiedosto,Kello.LineColor);  write(varitiedosto,Kello.BorderColor);  write(varitiedosto,Kello.PointerColor);  write(varitiedosto,Kello.Font.Color);  write(varitiedosto,Kello.FillColor);  write(varitiedosto,Jakokulma.LineColor);  write(varitiedosto,Jakokulma.Font.Color);  write(varitiedosto,Jakokulma.BgColor);  write(varitiedosto,Jakokulma.ModColor);  LineSquare := Numerotaulu.Lines[1,1];  write(varitiedosto,LineSquare.RightLine.Color);  write(varitiedosto,Numerotaulu.Font.Color);  write(varitiedosto,numerotaulkorostv);  write(varitiedosto,Numerotaulu.BgColor);  LineSquare := Kokoomataulu.Lines[1,1];  write(varitiedosto,LineSquare.RightLine.Color);  write(varitiedosto,Kokoomataulu.Font.Color);  write(varitiedosto,Kokoomataulu.BgColor);  LineSquare := Jaannostaulu.Lines[1,1];  write(varitiedosto,LineSquare.RightLine.Color);  write(varitiedosto,Jaannostaulu.Font.Color);  vari := Jaannostaulu.Colors[1,1];  write(varitiedosto,vari);  write(varitiedosto,Jaannostaulu.BgColor);  write(varitiedosto,Jaannostaululuontikorostv);  CloseFile(varitiedosto);end;procedure Tlomake.LataaVarit(Sender: TObject);var tdnimi : string;    varitiedosto : File of TColor;    vari : TColor;begin  OpenDialog.Execute;  tdnimi := OpenDialog.FileName;  AssignFile(varitiedosto,tdnimi);  Reset(varitiedosto);  read(varitiedosto,vari);  lomake.Color := vari;Kupla.FillColor := vari;  read(varitiedosto,vari);Kupla.Font.Color := vari;  read(varitiedosto,vari);Kupla.ColoredTextAreaColor := vari;  read(varitiedosto,vari);Laskuri.Font.Color := vari;  read(varitiedosto,vari);ErillinenKorostusLuku.Font.Color := vari;  read(varitiedosto,ErilKorostLukuKorostVari);  read(varitiedosto,vari);  KomentoPaneeli.Color := vari;VastausSelite.Color := vari;  read(varitiedosto,vari);  VastausSelite.Font.Color := vari;  VastausTieto.Font.Color := vari;  Syota.Font.Color := vari;  Edellinen.Font.Color := vari;  Seuraava.Font.Color := vari;  read(varitiedosto,vari);Kello.LineColor := vari;  read(varitiedosto,vari);Kello.BorderColor := vari;  read(varitiedosto,vari);Kello.PointerColor := vari;  read(varitiedosto,vari);Kello.Font.Color := vari;  read(varitiedosto,vari);Kello.FillColor := vari;  read(varitiedosto,vari);Jakokulma.LineColor := vari;  read(varitiedosto,vari);Jakokulma.Font.Color := vari;  read(varitiedosto,vari);Jakokulma.BgColor := vari;  read(varitiedosto,vari);Jakokulma.ModColor := vari;  read(varitiedosto,vari);  AsetaNumerotauluReunus(Sender,vari);  read(varitiedosto,vari);  asetaNumerotauluTekstiVari(Sender,vari);  read(varitiedosto,numerotaulkorostv);  read(varitiedosto,vari);Numerotaulu.BgColor := vari;  read(varitiedosto,vari);  AsetaKokoomatauluReunusVari(Sender,vari);  read(varitiedosto,vari);  AsetaKokoomatauluTekstiVari(Sender,vari);  read(varitiedosto,vari);Kokoomataulu.BgColor := vari;  read(varitiedosto,vari);  AsetaJaannostauluReunus(Sender,vari);  read(varitiedosto,vari);  AsetaJaannostauluTekstiVari(Sender,vari);  read(varitiedosto,vari);Jaannostaulu.Colors[1,1] := vari;  read(varitiedosto,vari);Jaannostaulu.BgColor := vari;  read(varitiedosto,Jaannostaululuontikorostv);  CloseFile(varitiedosto);  alustavarit(Sender);end;procedure Tlomake.alkupervarit(Sender:TObject);begin  Lomake.Color := clWhite;Kupla.FillColor := clWhite;  Kupla.Font.Color := clBlack;  Kupla.ColoredTextAreaColor := clRed;  laskuri.Font.Color := clBlack;  ErillinenKorostusLuku.Font.Color := clBlack;  ErilKorostLukuKorostVari := clRed;  KomentoPaneeli.Color := clWhite;  VastausSelite.Color := clWhite;  VastausSelite.Font.Color := clBlack;  VastausTieto.Font.Color := clBlack;  Syota.Font.Color := clBlack;  Edellinen.Font.Color := clBlack;  Seuraava.Font.Color := clBlack;  Kello.LineColor := clBlack;  Kello.BorderColor := clBlack;  Kello.PointerColor := clGreen;  Kello.Font.Color := clBlack;  Kello.FillColor := clWhite;  Jakokulma.LineColor := clBlack;  Jakokulma.Font.Color := clBlack;  Jakokulma.BgColor := clWhite;  Jakokulma.ModColor := clRed;  AsetaNumerotauluReunus(Sender,clBlack);  AsetaNumerotauluTekstiVari(Sender,clBlack);  numerotaulkorostv := clRed;  Numerotaulu.BgColor := clWhite;  AsetaKokoomatauluReunusVari(Sender,clBlack);  AsetaKokoomatauluTekstiVari(Sender,clBlack);  Kokoomataulu.BgColor := clWhite;  AsetaJaannostauluReunus(Sender,clBlack);  AsetaJaannostauluTekstiVari(Sender,clBlack);  Jaannostaulu.Colors[1,1] := clBlue;  Jaannostaululuontikorostv := clGreen;  Image.Visible := false;  Kokoomataulu.PaintAllOnCellChange := false;  Jaannostaulu.PaintAllOnCellChange := false;  Numerotaulu.PaintAllOnCellChange := false;  onvarit := false;  Lomake.RePaint;end;procedure Tlomake.Poistakuva(Sender:TObject);begin  Image.Visible := false;  Lomake.RePaint;end;procedure Tlomake.paivitaalkuun(Sender: TObject; var Action: TCloseAction);begin  vaihe := 1;end;procedure Tlomake.alkuas(Sender: TObject);begin  top := 0;left := 0;  height := 574;  width := 805;  vaihe := 1;maxvaihe := 52;  pyoritys := 0;  Edellinen.Visible := false;  Seuraava.visible := false;  Numerotaulu.visible := false;  Kello.visible := true;  Kello.PointerPlaceNumber := 12;  Kello.PointerTime := 12;  Timer.Enabled := false;  Laskuri.visible := false;  Kokoomataulu.Visible := false;  Jaannostaulu.visible := false;  jaannostaulkorostv := clBlue;  Kupla.ColoredTextAreaColor := clRed;  numerotaulkorostv := clRed;  Laskuriv := clBlack;  ErillinenKorostusLuku.visible := false;  asetanumerolaatikonalarivi( Sender );  toteutavaihe( Sender );end;procedure Tlomake.laitamuut(Sender: TObject; Stage: TProgressStage;  PercentDone: Byte; RedrawNow: Boolean; const R: TRect;  const Msg: String);begin  if kello.Visible then kello.RePaint;  if kupla.Visible then kupla.RePaint;  if numerotaulu.Visible then Numerotaulu.RePaint;  if Jaannostaulu.Visible then Jaannostaulu.RePaint;  if Kokoomataulu.Visible then Kokoomataulu.RePaint;  if Jakokulma.Visible then Jakokulma.RePaint;end;procedure Tlomake.Taustakuva(Sender: TObject);begin  OpenDialog.Execute;  Image.Picture.LoadFromFile(OpenDialog.FileName);  Image.Top := 0;Image.Left := 0;  Image.Width := 790;Image.Height := 424;  Image.Visible := true;  alustavarit(Sender);end;end.